# **என்கோடர் & டிகோடர்: இயல் மொழி தெளிதலின் இரு தூண்கள்**

கணினிகள் நம்மைப் போல தமிழ் பேசவோ, படிக்கவோ, புரிந்துகொள்ளவோ முடியாது. ஆனால்,  என்கோடர் மற்றும் டிகோடர் என்ற இரண்டு  சக்திவாய்ந்த கருவிகள் மூலம், தமிழ் மொழியை கணினிக்குப் புரியும்  எண்களாக மாற்றி, மீண்டும் தமிழிலேயே  பதில்களை உருவாக்க முடியும்.  என்கோடர் தமிழ் வார்த்தைகளை எண்களாக மாற்றும்; டிகோடர் அந்த எண்களை மீண்டும் தமிழ் வார்த்தைகளாக மாற்றும். இந்த தொழில்நுட்பம், இயந்திர மொழிபெயர்ப்பு,  உரை சுருக்கம்,  கேள்வி பதில் போன்ற பல  பணிகளுக்கு  உதவுகிறது.   என்கோடர் மற்றும் டிகோடர் எப்படி வேலை செய்கிறது என்பதை இந்த பதிவில் விரிவாகப் பார்க்கலாம்.

### **என்கோடர் (Encoder)**

**1. டோக்கனைசேஷன் (Tokenization): வார்த்தைகளை சிறு பகுதிகளாகப் பிரித்தல்**

சங்கத்தமிழ் பாடல் வரிகளை கம்ப்யூட்டருக்குப் புரியவைக்க, முதலில் அவற்றை சிறிய பகுதிகளாகப் பிரிக்க வேண்டும். இந்த சிறிய பகுதிகள் டோக்கன்கள் (Tokens) என்று அழைக்கப்படுகின்றன. உதாரணமாக, **"அகர முதல எழுத்தெல்லாம்"** என்ற வரியை எடுத்துக் கொள்வோம். டோக்கனைசேஷன் முறையில் இதை:

["அ", "க", "ர", " ", "மு", "த", "ல", " ", "எ", "ழு", "த்", "தெ", "ல்", "லா", "ம்"]

என்று பிரிக்கலாம். இங்கு இடைவெளிகளும் (" ") டோக்கன்களாகக் கருதப்படுகின்றன.

**2. சொல்லகராதி (Vocabulary) உருவாக்குதல்: ஒவ்வொரு டோக்கனுக்கும் தனித்துவமான எண்**

டோக்கனைசேஷன் செய்த பிறகு, ஒவ்வொரு டோக்கனுக்கும் ஒரு தனித்துவமான எண்ணை ஒதுக்க வேண்டும். இது ஒரு சொல்லகராதியை (Vocabulary) உருவாக்குவதற்கு உதவுகிறது.

உதாரணமாக:

- "அ" → 31
- "க" → 43
- "ர" → 59
- " " → 2
- "மு" → 57
- "த" → 69
- "ல" → 52
- "எ" → 61
- "ழு" → 37
- "த்" → 63
- "தெ" → 77
- "ல்" → 71
- "லா" → 66
- "ம்" → 88

இந்த சொல்லகராதி, ஒவ்வொரு டோக்கனையும் கம்ப்யூட்டருக்குப் புரியும் எண்ணாக மாற்ற உதவுகிறது.

**3. எம்பெடிங் (Embedding): எண்களை வெக்டர்களாக மாற்றுதல்**

ஒவ்வொரு டோக்கனுக்கும் ஒதுக்கப்பட்ட எண்ணை, எம்பெடிங் (Embedding) செயல்முறை மூலம் வெக்டர்களாக மாற்றுகிறோம். வெக்டர்கள் என்பது பல பரிமாணங்களைக் கொண்ட எண்களின் பட்டியல்.

"அகர முதல" என்ற டோக்கன்களை எண்களாக மாற்றிய பிறகு, [31, 43, 59, 2, 57, 69, 52] என்று கிடைக்கும். ஒவ்வொரு எண்ணையும் எம்பெடிங் செயல்முறை மூலம் வெக்டர்களாக மாற்றுகிறோம்.

- 31 → [0.1, -0.5, 0.8, ...]
- 43 → [0.2, 0.3, -0.1, ...]
- 59 → [-0.4, 0.6, 0.2, ...]
- 2 → [0.9, -0.2, 0.7, ...]
- 57 → [-0.3, 0.1, 0.5, ...]
- 69 → [0.7, 0.4, -0.6, ...]
- 52 → [-0.8, 0.9, 0.3, ...]

இந்த எம்பெடிங் வெக்டர்கள், ஒவ்வொரு டோக்கனின் அர்த்தத்தையும், தொடர்பையும் கம்ப்யூட்டருக்குப் புரிய வைக்க உதவுகின்றன.

**4. ஹிட்டன் ஸ்டேட்கள் (Hidden States): சூழல் தகவலை நினைவில் கொள்ளுதல்**

எம்பெடிங் செய்யப்பட்ட வெக்டர்களை, ரிக்கரண்ட் நியூரல் நெட்வொர்க் (RNN) போன்ற தொடர்முறை நரம்பியல் நெட்வொர்க்குகளைப் பயன்படுத்தி ஹிட்டன் ஸ்டேட்களாக மாற்றுகிறோம். 

RNN-ல் ஒவ்வொரு டோக்கனும் அனுப்பப்படும்போது, அது முந்தைய ஹிட்டன் ஸ்டேட்களை கணக்கில் கொண்டு ஒரு புதிய ஹிட்டன் ஸ்டேட் உருவாக்குகிறது. இந்த ஹிட்டன் ஸ்டேட்கள், வாக்கியத்தின் சூழலுக்கேற்ப விவரங்களைச் சேமிக்கின்றன.

உதாரணமாக:

- "அ" → Hidden State 1 (ஆரம்ப நிலை)
- "க" → Hidden State 2 (Hidden State 1 + "க")
- "ர" → Hidden State 3 (Hidden State 2 + "ர")
- " " → Hidden State 4 (Hidden State 3 + Space)
- "மு" → Hidden State 5 (Hidden State 4 + "மு")
- "த" → Hidden State 6 (Hidden State 5 + "த")
- "ல" → Hidden State 7 (Hidden State 6 + "ல")

ஒவ்வொரு ஹிட்டன் ஸ்டேட்டும் முந்தைய ஹிட்டன் ஸ்டேட்களின் தகவல்களை ஒருங்கிணைத்தே உருவாகிறது. எனவே, கடைசி ஹிட்டன் ஸ்டேட் (Hidden State 7) முழு வாக்கியத்தையும் பிரதிபலிக்கும்.

**5. கான்டெக்ஸ்ட் வெக்டர் (Context Vector): ஒட்டுமொத்த தகவலின் சுருக்கம்**

கான்டெக்ஸ்ட் வெக்டர் என்பது என்கோடரின் கடைசி ஹிட்டன் ஸ்டேட் ஆகும். இது, முழு வாக்கியத்தின் சாரத்தை சுருக்கமாக கொண்டிருக்கும்.

உதாரணமாக "அகர முதல" என்ற வாக்கியத்தின் கான்டெக்ஸ்ட் வெக்டர், Hidden State 7 ஆக இருக்கும். இது, முழு வாக்கியத்தின் அர்த்தத்தையும், சூழலையும் சுருக்கமாக கொண்டிருக்கும். இந்த கான்டெக்ஸ்ட் வெக்டர், டிகோடருக்கு முக்கியமான தகவலாகும். 

சரி, இப்போது டிகோடர் செயல்முறையை விரிவாகப் பார்ப்போம்.

### **டிகோடர் (Decoder) - எண்களை மீண்டும் சங்கத்தமிழ் பாடலாக மாற்றுதல்**

டிகோடர் என்பது என்கோடரால் உருவாக்கப்பட்ட கான்டெக்ஸ்ட் வெக்டரைப் பயன்படுத்தி,  மீண்டும் சங்கத்தமிழ் பாடல் வரிகளை உருவாக்கும் செயல்முறையாகும். இதுவும் பல படிகளைக் கொண்டது.

**1. இனிஷியல் ஸ்டேட் (Initial State): தொடக்க நிலை**

டிகோடரின் தொடக்க நிலை, என்கோடரின் கடைசி ஹிட்டன் ஸ்டேட்டாக (கான்டெக்ஸ்ட் வெக்டர்) இருக்கும். இது டிகோடருக்கு, மொழிபெயர்ப்பு அல்லது பாடல் வரி உருவாக்கத்திற்கான ஆரம்ப தகவலை வழங்குகிறது.

உதாரணமாக, "அகர முதல" என்ற வாக்கியத்திற்கு, என்கோடரின் கடைசி ஹிட்டன் ஸ்டேட் (Hidden State 7) டிகோடரின் ஆரம்ப நிலையாக கருத்தில் கொள்ளும்.

**2. டோக்கன் ஜெனரேஷன் (Token Generation): வார்த்தைகளை உருவாக்குதல்**

டிகோடர், கான்டெக்ஸ்ட் வெக்டரைப் பயன்படுத்தி அடுத்தடுத்த டோக்கன்களை உருவாக்குகிறது. ஒவ்வொரு டோக்கனும், முந்தைய டோக்கன்கள் மற்றும் கான்டெக்ஸ்ட் வெக்டரின் அடிப்படையில் உருவாக்கப்படும்.

இந்த டோக்கன் ஜெனரேஷன் செயல்முறை, பெரும்பாலும் ஒரு நியூரல் நெட்வொர்க் (Neural Network) மூலம் நிகழ்த்தப்படுகிறது. இந்த நெட்வொர்க், கான்டெக்ஸ்ட் வெக்டர் மற்றும் முந்தைய டோக்கன்களை உள்ளீடாகப் பெற்று, அடுத்த டோக்கனின் நிகழ்தகவு விரவல் (Probability Distribution) வெளியீடாகக் கொடுக்கும். அடுத்த டோக்கன் என்னவாக இருக்க வாய்ப்பிருக்கிறது என்பதைக் கண்டறிந்து அதற்கேற்ப டோக்கன்களை உருவாக்கும்.

உதாரணமாக, டிகோடர் முதன்முதலில் "அ" எனத் தொடங்குவதற்கான நிகழ்தகவு அதிகமாக இருக்கலாம். எனவே முதலில் '31' என்ற எண் உருவாக்கப்பட்டு, அடுத்து வரும் நிகழ்தகவுகளை வைத்து, '43' என்ற எண் உருவாகும், அடுத்து '59', அடுத்து '2' என, எண்களின் வரிசை உருவாக்கிக் கொண்டே போகும்.

**3. அகராதியைப் பயன்படுத்தி மீண்டும் உரைக்கு மாற்றுதல்**

**டோக்கன் உருவாக்கம் எவ்வாறு நிகழ்கிறது?**

```python
itos = {2: ' ', 31: 'அ', 43: 'க', 59: 'ர', 57: 'மு', 69: 'த', 52: 'ல', 61: 'எ', 37: 'ழு', 63: 'த்', 77: 'ெ', 71: 'ல்', 66: 'ா'}
```

இப்போது, நமக்குக் கொடுக்கப்பட்ட எண்களின் பட்டியலை எடுத்துக்கொள்வோம். பட்டியலில் உள்ள ஒவ்வொரு எண்ணையும் எடுத்துக்கொண்டு, அகராதியில் அதற்குரிய எழுத்தைப் பார்ப்போம். இந்த எழுத்துக்களை ஒன்றாக இணைத்தால், நமக்கு டெக்ஸ்ட் கிடைக்கும்.

**உதாரணம்:**

`[31, 43, 59, 2, 57, 69, 52, 61]` என்ற எண்களின் பட்டியலை எடுத்துக்கொள்வோம்.

- முதல் எண் 31. அகராதியில் 31 என்ற எண்ணுக்கு "அ" என்ற எழுத்து ஒதுக்கப்பட்டுள்ளது.
- இரண்டாவது எண் 43. அகராதியில் 43 என்ற எண்ணுக்கு "க" என்ற எழுத்து ஒதுக்கப்பட்டிருக்கலாம்.
- இதேபோல், மற்ற எண்களுக்கும் அகராதியில் உள்ள எழுத்துக்களை எடுத்துக்கொள்வோம்.

இறுதியில், `[31, 43, 59, 2, 57, 69, 52, 61]` என்ற எண்களின் பட்டியல் "அகர முதல" என்ற டெக்ஸ்ட்டாக மாறும்.

**4. டிகோடரின் செயல்பாடு**

டிகோடர், ஆட்டோரிக்ரஸிவ் (Autoregressive) முறையில் செயல்படுகிறது. அதாவது, ஒவ்வொரு டோக்கனையும் உருவாக்கிய பிறகு, அந்த டோக்கனை அடுத்த டோக்கனை உருவாக்க உள்ளீடாகப் பயன்படுத்துகிறது.

- "அ" என்ற டோக்கனை உருவாக்கிய பிறகு, "க" என்ற டோக்கனை உருவாக்க "அ" என்ற டோக்கனைப் பயன்படுத்துகிறது.
- "க" என்ற டோக்கனை உருவாக்கிய பிறகு, "ர" என்ற டோக்கனை உருவாக்க "அக" என்ற இரு டோக்கன்களையும் பயன்படுத்துகிறது.
- இந்த தொடர்ச்சியான செயல்முறை பாடல் வரி அல்லது வாக்கியம் முடியும் வரை நிகழும்.

**5. டிகோடரின் முடிவு**

டிகோடர், "EOS" (End of Sequence) என்ற சிறப்பு டோக்கனை உருவாக்கும் வரை டோக்கன்களை உருவாக்கிக் கொண்டே இருக்கும். "EOS" டோக்கன், பாடல் வரி முடிந்துவிட்டது என்பதைக் குறிக்கும்.

சுருக்கமாக டிகோடர், என்கோடரால் உருவாக்கப்பட்ட கான்டெக்ஸ்ட் வெக்டரைப் பயன்படுத்தி, சங்கத்தமிழ் பாடல் வரிகளை மீண்டும் உருவாக்குகிறது. இது, ஆட்டோரிக்ரஸிவ் முறையில் செயல்பட்டு, "EOS" டோக்கனை உருவாக்கும் வரை டோக்கன்களை உருவாக்கிக் கொண்டே இருக்கும். இந்த செயல்முறையின் மூலம், கம்ப்யூட்டர் சங்கத்தமிழ் பாடல்களைப் புரிந்துகொண்டு, அவற்றைப் பகுப்பாய்வு செய்யவும், மொழிபெயர்க்கவும், மற்ற பணிகளைச் செய்யவும் முடியும்.

என்கோடர் மற்றும் டிகோடர் இணைந்து செயல்படும் விதம், நாம் மொழியைப் புரிந்துகொண்டு பயன்படுத்தும் விதத்திற்கு ஒப்பானது. நாம் ஒரு வாக்கியத்தைப் படிக்கும்போது, அதன் அர்த்தத்தைப் புரிந்துகொண்டு, அதற்கு ஏற்றவாறு பதிலளிக்கிறோம். என்கோடர் மற்றும் டிகோடரும் இதேபோல் செயல்படுகின்றன. என்கோடர் வாக்கியத்தைப் புரிந்துகொண்டு அதை எண்களாக மாற்றுகிறது, டிகோடர் அந்த எண்களைப் பயன்படுத்தி பொருத்தமான பதிலை உருவாக்குகிறது.

இந்த தொழில்நுட்பம் இன்னும் வளர்ச்சியடைந்து வருகிறது. இதன் மூலம், எதிர்காலத்தில் கணினிகள் மனிதர்களைப் போலவே மொழியைப் புரிந்துகொண்டு பயன்படுத்தும் என்று நம்பலாம்.