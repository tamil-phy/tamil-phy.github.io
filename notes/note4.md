# Integrated Heart Model

The human heart is a marvel of biological engineering, seamlessly integrating electrical, mechanical, and fluid dynamics processes to sustain life. Modeling the heart's function is a monumental task, but with the advent of **Scientific Machine Learning (SciML)** and advanced computational techniques, we can now simulate the heart's behavior with remarkable accuracy. In this blog, we’ll explore the **Integrated Heart Model**, a mathematical framework that captures the heart's complexity through a combination of partial differential equations (PDEs), state equations, and constitutive relationships.

---

## 1. **The Integrated Heart Model: An Overview**

The Integrated Heart Model is a comprehensive framework that simulates the heart's electrical, mechanical, and fluid dynamics processes. It combines:

- **Cardiac Electrophysiology**: The propagation of electrical signals in the heart tissue.
- **Active Force Generation**: The contraction of heart muscle cells.
- **Blood Flow Dynamics**: The movement of blood through the heart and circulatory system.
- **Cardiac Mechanics**: The deformation of the heart muscle due to contraction and blood pressure.
- **Blood Circulation**: The interaction between the heart and the circulatory system.
- **Cardiac Perfusion**: Blood and oxygen supply to the heart muscle.
- **Torso Potential**: The generation of electrocardiogram (ECG) signals.

Let’s break down each component in detail.

---

## 2. **Cardiac Electrophysiology**

The heart's electrical activity is modeled using the bidomain equations:

$$
\chi C_m \frac{\partial v}{\partial t} - \nabla \cdot (D_i \nabla (v + v_e)) + \chi I_{\text{ion}}(v, z_{\text{ion}}) = I_{\text{app}}(x, t),
$$

where:

- $v$: Transmembrane potential.
- $v_e$: Extracellular potential.
- $z_{\text{ion}}$: Ionic state variables.
- $I_{\text{ion}}$: Ionic currents.

---

## 3. **Active Force Generation**

The contraction of heart muscle cells is driven by intracellular calcium concentration. The active force $T_a$ generated by the muscle cells is modeled as:

$$
\begin{aligned}
\frac{dz_{\text{act}}}{dt} = \Phi_{\text{act}}(z_{\text{act}}, [Ca^{2+}]_i), \\
T_a = \Psi_{\text{act}}(z_{\text{act}}),
\end{aligned}
$$

where:

- $z_{\text{act}}$: State variables for contractile proteins.
- $[Ca^{2+}]_i$: Intracellular calcium concentration.
- $T_a$: Active force generated by muscle cells.

This force drives the deformation of the heart muscle.

---

## 4. **Blood Flow Dynamics**

Blood flow through the heart and circulatory system is modeled using the **Navier–Stokes equations** in a moving domain. The flow rate $Q$ is given by:

$$
Q = K \Delta P
$$

where:

- $Q$: Blood flow.
- $\Delta P$: Pressure difference.
- $K$: Proportionality constant.

The Navier–Stokes equations are solved in a moving domain using the **Arbitrary Lagrangian–Eulerian (ALE)** framework to account for the deformation of the heart chambers.

---

## 5. **Cardiac Mechanics**

The contraction of cardiomyocytes and the pressure exerted by blood on the endocardium cause large deformations of the heart muscle. The deformation is modeled using the **momentum balance equation**:

$$
\rho \frac{\partial^2 \mathbf{d}}{\partial t^2} - \nabla \cdot \mathbf{P}(\mathbf{d}, z_{\text{act}}) = 0 \quad \text{in} \quad \hat{\Omega} \times (0, T)
$$

where:

- $\rho$: Mass density of the heart tissue.
- $\mathbf{d}$: Displacement of the tissue.
- $\mathbf{P}$: First Piola–Kirchhoff stress tensor, combining active and passive stresses.

The stress tensor $\mathbf{P}$ is split into:

- **Active stress** $\mathbf{P}_{\text{act}}$: Generated by muscle contraction.
- **Passive stress** $\mathbf{P}_{\text{pass}}$: Due to the elastic properties of the heart tissue.

---

## 6. **Blood and Valve Dynamics**

The heartbeat involves the coordinated interaction of the four heart chambers, with two primary phases:

1. **Ventricular Systole**: Contraction and blood ejection.
2. **Ventricular Diastole**: Relaxation and blood filling.

These processes are modeled using the **Navier–Stokes equations** in a moving domain, with the **Resistive Immersed Implicit Surface (RIIS)** method used to incorporate valve dynamics.

---

## 7. **Blood Circulation**

Blood circulation outside the heart is modeled using **zero-dimensional (lumped parameter) models**, which describe pressure and volume changes in the circulatory system using ordinary differential equations (ODEs):

$$
\frac{d\mathbf{z}_{\text{circ}}}{dt} = \Phi_{\text{circ}}(\mathbf{z}_{\text{circ}}, t)
$$

where $\mathbf{z}_{\text{circ}}(t)$ collects pressures and volumes in the circulatory system.

---

## 8. **Cardiac Perfusion**

Cardiac perfusion represents blood and oxygen supply via the coronary tree. The main coronary arteries are modeled using the **3D Navier–Stokes equations**, while the intramyocardial coronaries and microcirculation are modeled using a **multi-compartment Darcy model**.

---

## 9. **Torso Potential and ECG Generation**

To simulate the electrocardiogram (ECG), the electrical potential in the torso $\Omega_T$ is computed by solving:

$$
\begin{cases}
\text{Electrophysiology model} \quad \text{in} \quad \Omega_H, \\
-\nabla \cdot (\mathbf{D}_T \nabla v_T) = 0 \quad \text{in} \quad \Omega_T, \\
v_T = v_e \quad \text{on} \quad \Gamma, \\
(\mathbf{D}_T \nabla v_T) \cdot \mathbf{n} = (\mathbf{D}_e \nabla v_e) \cdot \mathbf{n} \quad \text{on} \quad \Gamma,
\end{cases}
$$

where:

- $v_T$: Electric potential in the torso.
- $v_e$: Extracellular potential in the heart.
- $\mathbf{D}_T$: Isotropic diffusion tensor in the torso.
- $\mathbf{D}_e$: Extracellular diffusivity tensor in the heart.

---

By combining **SciML** with advanced mathematical modeling, we can gain deeper insights into cardiac function, improve diagnostics, and develop personalized treatment strategies. As computational power and modeling techniques continue to advance, the Integrated Heart Model will play an increasingly important role in cardiovascular research and clinical practice.